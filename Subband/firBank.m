function [H] = firBank(M)
% FIR - 设计均匀滤波器组（分析滤波器组）
% 输入:
%   M  : 子带数量
% 输出:
%   H  : 滤波器组矩阵 (M x 63)，每行对应一个子带滤波器系数

% ===== 1. 设计低通滤波器（第一子带） =====
% 设计62阶(长度63)低通FIR滤波器
% 截止频率: 归一化频率1/M (对应数字频率π/M)
b = fir1(62, 1/M, 'low');  

% 初始化滤波器组矩阵
a = b;  % 第一行为低通滤波器系数

% ===== 2. 设计带通滤波器（中间子带） =====
for i = 1:M-2
    % 设计62阶带通滤波器
    % 通带: [i/M, (i+1)/M] (归一化频率)
    c = fir1(62, [i/M, (i+1)/M], 'bandpass');
    
    % 将新滤波器添加到矩阵下一行
    a = [a; c];  
end

% ===== 3. 设计高通滤波器（最后子带） =====
% 设计62阶高通滤波器
% 截止频率: (M-1)/M (归一化)
d = fir1(62, (M-1)/M, 'high');

% 将高通滤波器添加到矩阵最后一行
a = [a; d];  

% ===== 4. 返回结果 =====
H = a;  % 滤波器组矩阵 (M×63)
end
